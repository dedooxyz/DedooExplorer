<%- include('partials/header') %>

    <div class="statistics-page">
        <div class="page-header">
            <h1><i class="fas fa-chart-bar"></i> Network Statistics</h1>
            <p class="page-subtitle">Comprehensive analytics and insights into the <%= config.coinName %> blockchain</p>
        </div>

        <!-- Main Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-label">CURRENT HEIGHT</span>
                    <i class="fas fa-cube stat-icon"></i>
                </div>
                <div class="stat-value">
                    <%= formatNumber(tipHeight) %>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-label">NETWORK HASHRATE</span>
                    <i class="fas fa-tachometer-alt stat-icon"></i>
                </div>
                <div class="stat-value">
                    <%= formatHashrate(hashrate) %>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-label">AVG BLOCK TIME</span>
                    <i class="fas fa-clock stat-icon"></i>
                </div>
                <div class="stat-value">
                    <%= avgBlockTime %>s
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-label">DIFFICULTY</span>
                    <i class="fas fa-mountain stat-icon"></i>
                </div>
                <div class="stat-value">
                    <%= formatDifficulty(difficulty) %>
                </div>
            </div>
        </div>

        <!-- Time Period Selector -->
        <div class="time-selector">
            <button class="time-btn active" data-period="7">7 Days</button>
            <button class="time-btn" data-period="30">30 Days</button>
            <button class="time-btn" data-period="90">90 Days</button>
        </div>

        <!-- Charts Grid -->
        <div class="charts-grid">
            <!-- Daily Transaction Count -->
            <div class="content-card chart-card">
                <div class="card-header">
                    <h2><i class="fas fa-chart-line"></i> Daily Transaction Count</h2>
                </div>
                <div class="chart-container">
                    <canvas id="txCountChart"></canvas>
                </div>
            </div>

            <!-- Average Block Size -->
            <div class="content-card chart-card">
                <div class="card-header">
                    <h2><i class="fas fa-chart-bar"></i> Average Block Size</h2>
                </div>
                <div class="chart-container">
                    <canvas id="blockSizeChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Additional Stats -->
        <div class="content-card">
            <div class="card-header">
                <h2><i class="fas fa-info-circle"></i> Network Information</h2>
            </div>

            <div class="detail-grid">
                <div class="detail-item">
                    <span class="detail-label">Expected Block Time</span>
                    <span class="detail-value">
                        <%= config.blockTime %> seconds (<%= Math.round(config.blockTime / 60) %> minutes)
                    </span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Block Reward</span>
                    <span class="detail-value">100 <%= config.coinTicker %> (estimated)</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Algorithm</span>
                    <span class="detail-value">
                        <%= config.algorithm %>
                    </span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Difficulty Adjustment</span>
                    <span class="detail-value">
                        <%= config.diffAdjustment %>
                    </span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Chart data
        const dailyStats = <% - JSON.stringify(dailyStats) %>;

        // Transaction Count Chart
        const txCtx = document.getElementById('txCountChart').getContext('2d');
        new Chart(txCtx, {
            type: 'line',
            data: {
                labels: dailyStats.map(d => d.date),
                datasets: [{
                    label: 'Transactions',
                    data: dailyStats.map(d => d.txCount),
                    fill: true,
                    backgroundColor: 'rgba(245, 166, 35, 0.2)',
                    borderColor: '#F5A623',
                    borderWidth: 2,
                    tension: 0.4,
                    pointRadius: 4,
                    pointBackgroundColor: '#F5A623'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    x: {
                        grid: { color: 'rgba(255,255,255,0.05)' },
                        ticks: { color: '#888' }
                    },
                    y: {
                        grid: { color: 'rgba(255,255,255,0.05)' },
                        ticks: { color: '#888' },
                        beginAtZero: true
                    }
                }
            }
        });

        // Block Size Chart
        const sizeCtx = document.getElementById('blockSizeChart').getContext('2d');
        new Chart(sizeCtx, {
            type: 'bar',
            data: {
                labels: dailyStats.map(d => d.date),
                datasets: [{
                    label: 'Block Size (bytes)',
                    data: dailyStats.map(d => d.size),
                    backgroundColor: 'rgba(76, 217, 100, 0.7)',
                    borderColor: '#4CD964',
                    borderWidth: 1,
                    borderRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    x: {
                        grid: { color: 'rgba(255,255,255,0.05)' },
                        ticks: { color: '#888' }
                    },
                    y: {
                        grid: { color: 'rgba(255,255,255,0.05)' },
                        ticks: {
                            color: '#888',
                            callback: function (value) {
                                if (value >= 1000000) return (value / 1000000).toFixed(1) + ' MB';
                                if (value >= 1000) return (value / 1000).toFixed(1) + ' KB';
                                return value + ' B';
                            }
                        },
                        beginAtZero: true
                    }
                }
            }
        });
    </script>

    <%- include('partials/footer') %>